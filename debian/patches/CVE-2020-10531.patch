Patch taken from icu_55.1-7ubuntu0.5

Backported of:

From b7d08bc04a4296982fcef8b6b8a354a9e4e7afca Mon Sep 17 00:00:00 2001
From: Frank Tang <ftang@chromium.org>
Date: Sat, 1 Feb 2020 02:39:04 +0000
Subject: [PATCH] ICU-20958 Prevent SEGV_MAPERR in append

See #971
--- a/source/common/unistr.cpp
+++ b/source/common/unistr.cpp
@@ -73,6 +73,17 @@ print(const UChar *s,
 // END DEBUGGING
 #endif
 
+// Adding this function as support of CVE-2020-10531
+// since this version has not uprv_add32_overflow
+// implement it here.
+UBool uprv_add32_overflow(int32_t a, int32_t b, int32_t* res) {
+  int64_t a64 = static_cast<int64_t>(a);
+  int64_t b64 = static_cast<int64_t>(b);
+  int64_t res64 = a64 + b64;
+  *res = static_cast<int32_t>(res64);
+  return res64 != *res;
+}
+
 // Local function definitions for now
 
 // need to copy areas that may overlap
@@ -1372,7 +1383,11 @@ UnicodeString::doReplace(int32_t start,
     if(srcLength == 0) {
       return *this;
     }
-    newLength = oldLength + srcLength;
+    if (uprv_add32_overflow(oldLength, srcLength, &newLength)) {
+      setToBogus();
+      return *this;
+    }
+
     if(newLength <= getCapacity() && isBufferWritable()) {
       UChar *oldArray = getArrayStart();
       // Do not copy characters when
